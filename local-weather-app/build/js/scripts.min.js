"use strict";$(document).ready(function(){function t(t){var e=$(".metric-btn"),i=$(".imperial-btn"),a=$(".temp-box__value"),n=$(".wind__speed"),r=0,c=0;$(t).hasClass("metric-btn")&&!$(t).hasClass("metric-btn--active")?(c=n.html().match(/\d+/g),c=Math.round(c/2.237),n.html(c+" m/s"),r=a.html().split(",").shift(),r=Math.round((r-32)/1.8),a.html(r+", °C"),e.addClass("metric-btn--active"),i.removeClass("imperial-btn--active")):$(t).hasClass("imperial-btn")&&!$(t).hasClass("imperial-btn--active")&&(c=n.html().match(/\d+/g),c=Math.round(c/.44704),n.html(c+" mph"),r=a.html().split(",").shift(),r=Math.round(1.8*r+32),a.html(r+", °F"),i.addClass("imperial-btn--active"),e.removeClass("metric-btn--active"))}function e(t){var e=n(t.countryCode),r={},c="https://cors-anywhere.herokuapp.com/http://api.openweathermap.org/data/2.5/weather?q="+t.city+","+t.countryCode+"&units="+e+"&appid=e2db5b0453a25a492e87ad8b03046a7c";"metric"===e?(r.tempUnits="°C",r.windUnits="m/s"):(r.tempUnits="°F",r.windUnits="mph"),$.getJSON(c,function(e){a({country:t.country,city:t.city,weather:e.weather[0].main,weatherDetails:e.weather[0].description,windSpeed:e.wind.speed,windUnits:r.windUnits,windDirection:i(e.wind.deg),temp:e.main.temp,tempUnits:r.tempUnits,icon:e.weather[0].icon})})}function i(t){var e="";switch(!0){case t>0&&t<90:e="NE";break;case 90===t:e="E";break;case t>90&&t<180:e="SE";break;case 180===t:e="S";break;case t>180&&t<270:e="SW";break;case 270===t:e="W";break;case t>270&&t<360:e="NW";break;case 0===t||360===t:e="N";break;default:e="no wind direction data"}return e}function a(t){var e=$(".wrapper"),i=$(".temp-box__value"),a=$(".temp-box__icon"),n=$(".location"),r=$(".weather"),c=$(".wind").children(),s="https://openweathermap.org/img/w/"+t.icon+".png",m=$(".metric-btn"),o=$(".imperial-btn"),d={Thunderstorm:"img/thunderstorm.jpg",Drizzle:"img/drizzle.jpg",Rain:"img/rain.jpg",Snow:"img/snow.jpg",Clear:"img/clear.jpg",Clouds:"img/clouds.jpg"};for(var p in d)p===t.weather?e.css({"background-image":"url("+d[t.weather]+")"}):e.css({"background-color":"#E8F1F2"});"°C"===t.tempUnits?m.addClass("metric-btn--active"):o.addClass("imperial-btn--active"),a.css({"background-image":"url("+s+")"}),i.html(t.temp+", "+t.tempUnits),n.html(t.city+", "+t.country),r.html(t.weather+", "+t.weatherDetails),$(c[0]).html(t.windDirection+",&nbsp;"),$(c[1]).html(t.windSpeed+" "+t.windUnits)}function n(t){return-1===["US","BS","BZ","KY","PW"].indexOf(t)?"metric":"imperial"}$.getJSON("https://ipapi.co/json/").then(function(t){e({city:t.city,country:t.country_name,countryCode:t.country})}),$(".units-toggle").on("click",function(e){t(e.target)})});